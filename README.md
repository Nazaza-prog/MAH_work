# –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –í—Ç–æ—Ä–∏–Ω–Ω–æ—ó –°—Ç—Ä—É–∫—Ç—É—Ä–∏ –ë—ñ–ª–∫—ñ–≤ (SSP)

–ü—Ä–æ–µ–∫—Ç –¥–ª—è –ú–∞–ª–æ—ó –ê–∫–∞–¥–µ–º—ñ—ó –ù–∞—É–∫ –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∏: –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –≤—Ç–æ—Ä–∏–Ω–Ω–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –±—ñ–ª–∫—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≥–ª–∏–±–æ–∫–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è.

## üìã –ó–º—ñ—Å—Ç

- [–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è](#–≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è)
- [–®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç](#—à–≤–∏–¥–∫–∏–π-—Å—Ç–∞—Ä—Ç)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç—É)
- [–ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏](#–µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏)
- [–†–µ–∑—É–ª—å—Ç–∞—Ç–∏](#—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏)

## üöÄ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

### 1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é

```bash
git clone <your-repo-url>
cd protein-ssp-project
```

### 2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞

```bash
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# –∞–±–æ
venv\Scripts\activate  # Windows
```

### 3. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

## üèÉ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### –ö—Ä–æ–∫ 1: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö

```bash
python scripts/download_cb513.py
```

–¶–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç—å –¥–∞—Ç–∞—Å–µ—Ç CB513 (~100MB) –¥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó `data/raw/cb513/`.

### –ö—Ä–æ–∫ 2: –î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö (–æ–ø—Ü—ñ–π–Ω–æ)

```bash
jupyter notebook notebooks/01_data_exploration.ipynb
```

### –ö—Ä–æ–∫ 3: –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –±–∞–∑–æ–≤–æ—ó –º–æ–¥–µ–ª—ñ

```bash
python scripts/train_baseline.py
```

–¶–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è CNN –º–æ–¥–µ–ª—ñ –∑ One-Hot encoding. –û—á—ñ–∫—É–≤–∞–Ω–∏–π —á–∞—Å –Ω–∞ GPU: ~2-3 –≥–æ–¥–∏–Ω–∏.

**–û—á—ñ–∫—É–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏:**
- Q3 Accuracy: ~73-75%
- Q8 Accuracy: ~52-55%
- SOV: ~65-70%

### –ö—Ä–æ–∫ 4: –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è

–í —ñ–Ω—à–æ–º—É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ –∑–∞–ø—É—Å—Ç—ñ—Ç—å TensorBoard:

```bash
tensorboard --logdir=results/baseline/tensorboard
```

–í—ñ–¥–∫—Ä–∏–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: http://localhost:6006

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
protein-ssp-project/
‚îú‚îÄ‚îÄ data/                      # –î–∞–Ω—ñ
‚îÇ   ‚îú‚îÄ‚îÄ raw/cb513/            # CB513 dataset
‚îÇ   ‚îî‚îÄ‚îÄ processed/            # –û–±—Ä–æ–±–ª–µ–Ω—ñ –¥–∞–Ω—ñ
‚îú‚îÄ‚îÄ src/                       # –í–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dataset.py        # PyTorch Dataset
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cnn_baseline.py   # CNN –º–æ–¥–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ training/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ trainer.py        # Training pipeline
‚îÇ   ‚îî‚îÄ‚îÄ evaluation/
‚îÇ       ‚îî‚îÄ‚îÄ metrics.py        # –ú–µ—Ç—Ä–∏–∫–∏ (Q3, Q8, SOV)
‚îú‚îÄ‚îÄ scripts/                   # –°–∫—Ä–∏–ø—Ç–∏ –∑–∞–ø—É—Å–∫—É
‚îÇ   ‚îú‚îÄ‚îÄ download_cb513.py     # –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
‚îÇ   ‚îî‚îÄ‚îÄ train_baseline.py     # –¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è
‚îú‚îÄ‚îÄ configs/                   # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
‚îÇ   ‚îî‚îÄ‚îÄ baseline_config.yaml  # –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –º–æ–¥–µ–ª—ñ
‚îú‚îÄ‚îÄ notebooks/                 # Jupyter notebooks
‚îÇ   ‚îî‚îÄ‚îÄ 01_data_exploration.ipynb
‚îú‚îÄ‚îÄ models/                    # –ó–±–µ—Ä–µ–∂–µ–Ω—ñ –º–æ–¥–µ–ª—ñ
‚îÇ   ‚îî‚îÄ‚îÄ baseline/
‚îÇ       ‚îî‚îÄ‚îÄ best_model.pth
‚îî‚îÄ‚îÄ results/                   # –†–µ–∑—É–ª—å—Ç–∞—Ç–∏
    ‚îî‚îÄ‚îÄ baseline/
        ‚îú‚îÄ‚îÄ training_history.json
        ‚îî‚îÄ‚îÄ test_results.json
```

## üî¨ –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏

### –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 1: Baseline (CNN + One-Hot)

**–ì—ñ–ø–æ—Ç–µ–∑–∞:** –ü—Ä–æ—Å—Ç–∞ CNN –º–æ–¥–µ–ª—å –∑ One-Hot encoding –º–æ–∂–µ –Ω–∞–≤—á–∏—Ç–∏—Å—è –±–∞–∑–æ–≤–∏–º –ø–∞—Ç–µ—Ä–Ω–∞–º –≤—Ç–æ—Ä–∏–Ω–Ω–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏.

**–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è:**
- –í—Ö—ñ–¥: 21√ó20 (window_size √ó amino_acids)
- –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞: 3 Conv —à–∞—Ä–∏ + FC layers
- –û–ø—Ç–∏–º—ñ–∑–∞—Ç–æ—Ä: Adam (lr=0.001)

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
python scripts/train_baseline.py
```

### –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 2: Enhanced (CNN + PSSM)

**–ì—ñ–ø–æ—Ç–µ–∑–∞:** –î–æ–¥–∞–≤–∞–Ω–Ω—è –µ–≤–æ–ª—é—Ü—ñ–π–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó (PSSM) –∑–Ω–∞—á–Ω–æ –ø–æ–∫—Ä–∞—â–∏—Ç—å —Ç–æ—á–Ω—ñ—Å—Ç—å, –æ—Å–æ–±–ª–∏–≤–æ –¥–ª—è Q8.

**–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞:**
```bash
# –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è PSSM –ø—Ä–æ—Ñ—ñ–ª—ñ–≤ (–ø–æ—Ç—Ä–µ–±—É—î PSI-BLAST)
python scripts/generate_pssm.py
```

**–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è:**
- –í—Ö—ñ–¥: 21√ó43 (window_size √ó (amino_acids + pssm))
- –†–µ—à—Ç–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –∞–Ω–∞–ª–æ–≥—ñ—á–Ω–æ Exp 1

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
python scripts/train_enhanced.py
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç–∏

### –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –º–æ–¥–µ–ª–µ–π

| –ú–æ–¥–µ–ª—å | Q3 Accuracy | Q8 Accuracy | SOV | –ß–∞—Å —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è |
|--------|-------------|-------------|-----|----------------|
| Baseline (One-Hot) | ~73% | ~52% | ~67% | 2-3 –≥–æ–¥ |
| Enhanced (PSSM) | ~78% | ~60% | ~72% | 3-4 –≥–æ–¥ |
| SOTA (Porter 6) | 84.56% | 74.18% | - | - |

### –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

```python
# –£ Jupyter notebook
from src.utils.visualization import plot_training_history

plot_training_history('results/baseline/training_history.json')
```

## üõ†Ô∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

–í—Å—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤ `configs/baseline_config.yaml`:

```yaml
# –ü—Ä–∏–∫–ª–∞–¥ –≤–∞–∂–ª–∏–≤–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤
training:
  batch_size: 64
  num_epochs: 100
  learning_rate: 0.001
  
model:
  dropout: 0.5
  num_classes_q3: 3
```

## üìù –ù–∞—É–∫–æ–≤–∞ –†–æ–±–æ—Ç–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–≤—ñ—Ç—É

1. **–í—Å—Ç—É–ø**
   - –ê–∫—Ç—É–∞–ª—å–Ω—ñ—Å—Ç—å SSP
   - –ú–µ—Ç–∞ —Ç–∞ –∑–∞–≤–¥–∞–Ω–Ω—è

2. **–û–≥–ª—è–¥ –ª—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∏**
   - –Ü—î—Ä–∞—Ä—Ö—ñ—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –±—ñ–ª–∫–∞
   - –ú–µ—Ç–æ–¥–∏ SSP (–≤—ñ–¥ —Ä–∞–Ω–Ω—ñ—Ö –¥–æ SOTA)

3. **–ú–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—è**
   - –î–∞—Ç–∞—Å–µ—Ç CB513
   - –Ü–Ω–∂–µ–Ω–µ—Ä—ñ—è –æ–∑–Ω–∞–∫ (One-Hot, PSSM)
   - –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ CNN

4. **–ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞**
   - Exp 1: Baseline
   - Exp 2: Enhanced
   - –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

5. **–í–∏—Å–Ω–æ–≤–∫–∏**
   - –í–ø–ª–∏–≤ PSSM –Ω–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å
   - –ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∏ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

### –ö–ª—é—á–æ–≤—ñ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É

- **Q3/Q8 Accuracy:** –∑–∞–≥–∞–ª—å–Ω–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- **SOV:** —è–∫—ñ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è —Å–µ–≥–º–µ–Ω—Ç—ñ–≤
- **Per-class F1:** —Ç–æ—á–Ω—ñ—Å—Ç—å –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ç–∏–ø—É —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ (H, E, C)

## üîç Troubleshooting

### CUDA out of memory

–ó–º–µ–Ω—à—ñ—Ç—å `batch_size` –≤ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó:
```yaml
training:
  batch_size: 32  # –∑–∞–º—ñ—Å—Ç—å 64
```

### –ü–æ–≤—ñ–ª—å–Ω–µ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –º–µ–Ω—à–µ `num_workers`:
```python
create_dataloaders(..., num_workers=2)
```

### –ù–µ —Å—Ö–æ–¥–∏—Ç—å—Å—è loss

–°–ø—Ä–æ–±—É–π—Ç–µ –∑–º–µ–Ω—à–∏—Ç–∏ learning rate:
```yaml
training:
  learning_rate: 0.0001  # –∑–∞–º—ñ—Å—Ç—å 0.001
```

## üìö –†–µ—Å—É—Ä—Å–∏

- [DSSP Documentation](https://swift.cmbi.umcn.nl/gv/dssp/)
- [PyTorch Tutorials](https://pytorch.org/tutorials/)
- [CB513 Dataset Paper](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3041573/)
- [Porter 6 Paper](https://www.mdpi.com/1422-0067/26/1/130)

## üìß –ö–æ–Ω—Ç–∞–∫—Ç

–Ø–∫—â–æ –≤–∏–Ω–∏–∫–ª–∏ –ø–∏—Ç–∞–Ω–Ω—è, —Å—Ç–≤–æ—Ä—ñ—Ç—å Issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó.

## üìÑ –õ—ñ—Ü–µ–Ω–∑—ñ—è

MIT License
